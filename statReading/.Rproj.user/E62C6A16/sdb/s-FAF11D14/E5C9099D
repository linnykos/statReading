{
    "collab_server" : "",
    "contents" : "#create a density over a grid\ncreate_prob_grid <- function(xlim, ylim, density_func, grid_size = 200){\n  xseq <- seq(xlim[1], xlim[2], length.out = grid_size)\n  yseq <- seq(ylim[1], ylim[2], length.out = grid_size)\n\n  mat <- sapply(yseq, function(y){ sapply(xseq, function(x){density_func(x,y)})})\n  rownames(mat) <- yseq; colnames(mat) <- xseq\n  mat/sum(mat)\n}\n\n#plot the density\nplot_grid <- function(mat, type = c(\"contour\"), alpha = 0.5, nlevels = 10, ...){\n  xseq <- as.numeric(colnames(mat)); yseq <- as.numeric(rownames(mat))\n\n  image(xseq, yseq, mat, col = grDevices::heat.colors(100, alpha = alpha), ...)\n  contour(xseq, yseq, mat, nlevels = nlevels, add = T, drawlabels = F, ...)\n}\n\n#sample from the density grid\nsample_from_grid <- function(mat, n = 50){\n  xseq <- as.numeric(colnames(mat)); yseq <- as.numeric(rownames(mat))\n  h <- nrow(mat); w <- ncol(mat)\n  vec <- as.numeric(mat); len <- length(vec)\n  idx <- sample(1:len, n, prob = vec, replace = T)\n\n  dat <- sapply(idx, function(i){\n    x <- ifelse(i %% h == 0, h, i %% h)\n    y <- floor(i/h)\n    c(xseq[x],yseq[y])\n  })\n\n  t(dat)\n}\n\n#compute the OLS coefficient (no intercept)\nols <- function(dat){\n  x <- dat[,1]; y <- dat[,2]\n\n  as.numeric((t(x)%*%x)^(-1)*t(x)%*%y)\n}\n\n#add the OLS regression line to plot\nplot_ols <- function(res, xlim, ...){\n  y1 <- res*xlim[1]; y2 <- res*xlim[2]\n  graphics::lines(xlim, c(y1, y2), ...)\n}\n\n#compute the population OLS coefficent based on the grid, minimizing expected risk\npopulation_ols <- function(mat, betalim, spacing = 500){\n  betaseq <- seq(betalim[1], betalim[2], length.out = spacing)\n  xseq <- as.numeric(colnames(mat)); yseq <- as.numeric(rownames(mat))\n  vec <- as.numeric(mat)\n  grid <- expand.grid(xseq, yseq)\n\n  risk_vec <- sapply(betaseq, function(beta){\n    (grid[,1]*beta - grid[,2])^2 %*% vec\n  })\n\n  idx <- which.min(risk_vec)\n  betaseq[idx]\n}\n\n#assumes population sd is 1\npopulation_ols_kl <- function(mat, betalim, spacing = 500){\n  betaseq <- seq(betalim[1], betalim[2], length.out = spacing)\n  xseq <- as.numeric(colnames(mat)); yseq <- as.numeric(rownames(mat))\n  vec <- as.numeric(mat)\n  grid <- expand.grid(xseq, yseq)\n\n  risk_vec <- sapply(betaseq, function(beta){\n    #compute the new grid\n    mle_vec <- sapply(grid[,1]*beta - grid[,2], dnorm)\n    log(vec/mle_vec)%*%vec\n  })\n\n  idx <- which.min(risk_vec)\n  betaseq[idx]\n}\n",
    "created" : 1505328606835.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3933211921",
    "id" : "E5C9099D",
    "lastKnownWriteTime" : 1505336373,
    "last_content_update" : 1505336373210,
    "path" : "~/Dropbox/random/statReading/statReading/R/regression.R",
    "project_path" : "R/regression.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}